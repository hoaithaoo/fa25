<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${contract.contractType == 'DEPOSIT'} ? 'Hợp Đồng Đặt Cọc Xe' : 'Hợp Đồng Mua Bán Xe'">Hợp Đồng</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 30px;
            border-bottom: 2px solid #333;
            padding-bottom: 20px;
        }

        .company-info {
            flex: 1;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 5px;
        }

        .company-details {
            font-size: 11px;
            line-height: 1.4;
            color: #333;
        }

        .title {
            text-align: center;
            margin: 30px 0;
        }

        .title h1 {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .title p {
            font-size: 12px;
            font-style: italic;
            color: #666;
        }

        .section {
            margin-bottom: 25px;
        }

        .section-title {
            font-weight: bold;
            font-size: 13px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .info-row {
            display: flex;
            margin-bottom: 8px;
            font-size: 13px;
            line-height: 1.6;
        }

        .info-label {
            min-width: 120px;
            font-weight: 500;
        }

        .info-value {
            flex: 1;
            border-bottom: 1px dotted #999;
            padding-left: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 13px;
        }

        table th, table td {
            border: 1px solid #333;
            padding: 10px;
            text-align: left;
        }

        table th {
            background: #f0f0f0;
            font-weight: bold;
            text-align: center;
        }

        .vehicle-details {
            list-style: none;
            padding-left: 15px;
        }

        .vehicle-details li {
            margin: 5px 0;
            font-size: 12px;
        }

        .vehicle-details li:before {
            content: "- ";
            margin-right: 5px;
        }

        .price-total {
            font-weight: bold;
            font-style: italic;
        }

        .note {
            font-style: italic;
            font-size: 12px;
            margin-top: 5px;
            color: #666;
        }

        .article {
            margin: 20px 0;
        }

        .article-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 13px;
        }

        .article-content {
            font-size: 13px;
            line-height: 1.8;
            text-align: justify;
        }

        .article-content ul {
            margin: 10px 0;
            padding-left: 25px;
        }

        .article-content li {
            margin: 5px 0;
        }

        .signatures {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            text-align: center;
        }

        .signature-box {
            flex: 1;
            padding: 20px;
        }

        .signature-box h3 {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .signature-box .subtitle {
            font-size: 12px;
            font-style: italic;
            margin-bottom: 80px;
        }

        .stamp {
            position: relative;
            margin: 20px auto;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <div class="company-info">
            <div class="logo">ELECTRA</div>
            <div class="company-details">
                <strong th:text="${order.storeName}"></strong><br>
                Địa chỉ: <span style="text-decoration: underline;" th:text="${order.storeAddress}"></span><br>
                <strong>ĐT:</strong> ..................... - <strong>MST:</strong> ..................... <br>
            </div>
        </div>
    </div>

    <div class="title">
        <h1 th:text="${contract.contractType == 'DEPOSIT'} ? 'HỢP ĐỒNG ĐẶT CỌC XE' : 'HỢP ĐỒNG MUA BÁN XE'">HỢP ĐỒNG</h1>
        <p>Số: <span th:text="${contract.contractCode}">............../HD/XD</span> - <span th:text="${contract.contractType == 'DEPOSIT'} ? 'DC' : 'MB'">BMVLVL</span><br>
            <span th:text="${#temporals.format(contract.contractDate, 'dd')}">...</span>, ngày <span th:text="${#temporals.format(contract.contractDate, 'MM')}">...</span> tháng <span th:text="${#temporals.format(contract.contractDate, 'yyyy')}">20...</span><br>
            Chúng tôi gồm có bên:</p>
    </div>

    <div class="section">
        <div class="section-title">BÊN BÁN (BÊN A):</div>
        <div class="info-row">
            <span class="info-label">Tên:</span>
            <span class="info-value" th:text="${store.ownerName}"></span>
        </div>
<!--        <div class="info-row">-->
<!--            <span class="info-label">MSDN:</span>-->
<!--            <span class="info-value"></span>-->
<!--        </div>-->
        <div class="info-row">
            <span class="info-label">Địa chỉ:</span>
            <span class="info-value" th:text="${store.address}"></span>
        </div>
<!--        <div class="info-row">-->
<!--            <span class="info-label">Đại diện:</span>-->
<!--            <span class="info-value"></span>-->
<!--        </div>-->
        <div class="info-row">
            <span class="info-label">Điện thoại:</span>
            <span class="info-value" th:text="${store.phone}"></span>
        </div>
<!--        <div class="info-row">-->
<!--            <span class="info-label">Tài khoản:</span>-->
<!--            <span class="info-value"></span>-->
<!--        </div>-->
        <div class="info-row">
<!--            <span class="info-label">Mở tại:</span>-->
<!--            <span class="info-value"></span>-->
            <span class="info-label">Chức vụ:</span>
            <span class="info-value">Chủ đại lý</span>
        </div>
    </div>

    <div class="section">
        <div class="section-title">BÊN MUA (BÊN B):</div>
        <div class="info-row">
            <span class="info-label">Họ và tên:</span>
            <span class="info-value" th:text="${customer.fullName}"></span>
        </div>
<!--        <div class="info-row">-->
<!--            <span class="info-label">Ngày sinh:</span>-->
<!--            <span class="info-value"></span>-->
<!--        </div>-->
        <div class="info-row">
            <span class="info-label">CMND/CCCD:</span>
            <span class="info-value" th:text="${customer.identificationNumber}"></span>
        </div>
        <div class="info-row">
            <span class="info-label">Địa chỉ hiện tại:</span>
            <span class="info-value" th:text="${customer.address}"></span>
        </div>
        <div class="info-row">
            <span class="info-label">Số điện thoại:</span>
            <span class="info-value" th:text="${customer.phone}"></span>
        </div>
        <p style="font-size: 13px; margin-top: 10px; line-height: 1.6;">
            <span th:if="${contract.contractType == 'DEPOSIT'}">Sau khi bàn bạc thỏa thuận, hai bên cùng nhau thống nhất ký kết hợp đồng đặt cọc xe ô tô điện với các điều khoản như sau:</span>
            <span th:if="${contract.contractType == 'SALE'}">Sau khi bàn bạc thỏa thuận, hai bên cùng nhau thống nhất ký kết hợp đồng mua bán xe ô tô điện với các điều khoản như sau:</span>
        </p>
    </div>

    <div class="article">
        <div class="article-title">ĐIỀU 1. ĐỐI TƯỢNG HỢP ĐỒNG</div>
        <table>
            <thead>
            <tr>
                <th>STT</th>
                <th>Mô tả hàng hóa</th>
                <th>Đơn giá<br>(Đã gồm VAT)</th>
                <th>Khuyến mãi (nếu có)</th>
                <th>Phí dịch vụ (nếu có)</th>
                <th>Thành tiền<br>(Đã gồm VAT)</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="dto, counter : ${order.orderDetailsList}">
                <td style="text-align: center;" th:text="${counter.count}">STT</td>
                <td>
                    <strong> <span>Mẫu xe: </span> <span th:text="${dto.modelName}"></span> </strong>
                    <ul class="vehicle-details">
                        <li> <span>Kiểu dáng xe: </span> <span th:text="${dto.bodyType}"></span> </li>
                        <li> <span>Số chỗ ngồi: </span> <span th:text="${dto.seatingCapacity}"></span> </li>
                        <li> <span>Năm sản xuất: </span> <span th:text="${dto.modelYear}"></span> </li>
                        <li> <span>Màu sơn: </span> <span th:text="${dto.colorName}"></span> </li>
                        <li th:if="${dto.vin != null and dto.vin != ''}"> 
                            <span>Số khung (VIN): </span> 
                            <span th:text="${dto.vin}" style="font-weight: bold;"></span> 
                        </li>
                        <li th:if="${dto.engineNo != null and dto.engineNo != ''}"> 
                            <span>Số máy: </span> 
                            <span th:text="${dto.engineNo}" style="font-weight: bold;"></span> 
                        </li>
                        <li th:if="${dto.batteryNo != null and dto.batteryNo != ''}"> 
                            <span>Số seri pin: </span> 
                            <span th:text="${dto.batteryNo}" style="font-weight: bold;"></span> 
                        </li>
                    </ul>
                </td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(dto.unitPrice, 0, 'COMMA', 0, 'POINT')}">Đơn giá</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(dto.discount, 0, 'COMMA', 0, 'POINT')}">Khuyến mãi</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(dto.totalTax, 0, 'COMMA', 0, 'POINT')}">Phí dịch vụ</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(dto.totalPrice, 0, 'COMMA', 0, 'POINT')}">Tổng tiền</td>
            </tr>
            <tr>
                <td colspan="2" class="price-total" th:text="${contract.contractType == 'DEPOSIT'} ? 'Tổng Giá trị Hợp đồng (Tạm tính)' : 'Tổng Giá trị Hợp đồng'">Tổng Giá trị Hợp đồng</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(order.totalUnitPrice, 0, 'COMMA', 0, 'POINT')}">Tổng đơn giá</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(order.totalDiscount, 0, 'COMMA', 0, 'POINT')}">Tổng khuyến mãi</td>
                <td style="text-align: right;" th:text="${#numbers.formatDecimal(order.totalTaxPrice, 0, 'COMMA', 0, 'POINT')}">Tổng dịch vụ</td>
                <td style="text-align: right;">
                    <span th:if="${contract.contractType == 'DEPOSIT'}">
                        <span th:text="${#numbers.formatDecimal(contract.totalPayment, 0, 'COMMA', 0, 'POINT')}">Tiền cọc</span>
                    </span>
                    <span th:if="${contract.contractType == 'SALE'}">
                        <span th:text="${#numbers.formatDecimal(contract.totalPayment, 0, 'COMMA', 0, 'POINT')}">Tổng thanh toán</span>
                    </span>
                </td>
            </tr>
            </tbody>
        </table>
        <p class="note">Bằng chữ: .......................... -/-.</p>
    </div>

    <div class="article" th:if="${contract.contractType == 'DEPOSIT'}">
        <div class="article-title">ĐIỀU 2. ĐẶT CỌC VÀ CAM KẾT GIAO XE</div>
        <div class="article-content">
            <p>Hai bên đã thống nhất về việc đặt cọc và cam kết giao xe như sau:</p>
            <ul>
                <li><strong>1. Tình trạng thanh toán cọc: </strong>
                    Bên B đã thực hiện đặt cọc thành công cho Bên A với số tiền là 
                    <strong th:text="${#numbers.formatDecimal(contract.totalPayment, 0, 'COMMA', 0, 'POINT')}">...</strong> VNĐ
                    (tương đương 20% giá trị hợp đồng). Khoản đặt cọc này được xác nhận đã được chuyển khoản/thực hiện thanh toán thành công.</li>
                
                <li><strong>2. Cam kết của Bên A (Đại lý): </strong>
                    Bên A cam kết sẽ giao đúng xe theo đúng thông tin đã thỏa thuận cho Bên B trong thời hạn 
                    <strong>07 (bảy) ngày làm việc</strong> kể từ ngày ký hợp đồng đặt cọc này. Xe được giao phải đúng với mô tả 
                    trong ĐIỀU 1 về đối tượng hợp đồng.</li>
                
                <li><strong>3. Quy định về vi phạm của Bên A: </strong>
                    Trong trường hợp Bên A không thể giao xe đúng hạn trong vòng 07 (bảy) ngày làm việc như đã cam kết, 
                    Bên A có trách nhiệm:
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Hoàn trả lại toàn bộ số tiền đặt cọc cho Bên B;</li>
                        <li>Bồi thường cho Bên B một khoản tiền tương đương với số tiền đặt cọc đã nhận.</li>
                    </ul>
                </li>
                
                <li><strong>4. Quy định về vi phạm của Bên B: </strong>
                    Trong trường hợp Bên B từ chối hoặc không thực hiện việc mua xe sau khi Bên A đã sẵn sàng giao xe đúng hạn:
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>Bên A có quyền đơn phương hủy hợp đồng đặt cọc này;</li>
                        <li>Bên B sẽ mất hoàn toàn số tiền đặt cọc đã thanh toán và không được đòi lại bất kỳ khoản tiền nào;</li>
                        <li>Số tiền đặt cọc sẽ thuộc về Bên A như một khoản bồi thường cho việc vi phạm hợp đồng của Bên B.</li>
                    </ul>
                </li>
                
                <li><strong>5. Thanh toán còn lại: </strong>
                    Sau khi Bên A giao xe đúng hạn và Bên B xác nhận nhận xe, Bên B sẽ thanh toán số tiền còn lại 
                    khi ký kết hợp đồng mua bán chính thức (Hợp đồng mua bán xe). Số tiền đặt cọc này sẽ được trừ vào 
                    tổng giá trị hợp đồng mua bán.                </li>
            </ul>
        </div>
    </div>

    <div class="article" th:if="${contract.contractType == 'DEPOSIT'}">
        <div class="article-title">ĐIỀU 3. GIAO HÀNG VÀ NHẬN HÀNG</div>
        <div class="article-content">
            <ul>
                <li><strong>Thời hạn giao xe: </strong>Bên A sẽ giao xe cho Bên B trong thời hạn <strong>07 (bảy) ngày làm việc</strong> kể từ ngày ký hợp đồng đặt cọc này;</li>
                <li><strong>Địa điểm giao xe: </strong>Tại trụ sở của Bên A;</li>
                <li><strong>Phương thức giao xe: </strong>Bên A sẽ giao xe trực tiếp cho Bên B, Bên B có trách nhiệm kiểm tra tình trạng xe 
                    trước khi nhận;</li>
                <li><strong>Giấy tờ kèm theo: </strong>Bên A sẽ giao kèm theo xe các giấy tờ liên quan theo quy định của pháp luật.</li>
            </ul>
        </div>
    </div>

    <div class="article" th:if="${contract.contractType == 'SALE'}">
        <div class="article-title">ĐIỀU 2. THANH TOÁN</div>
        <div class="article-content">
            <p>Bên B thực hiện thanh toán giá trị hợp đồng cho Bên A như sau:</p>
            <ul>
                <li><strong>Thanh toán: </strong>Bên B thanh toán toàn bộ giá trị hợp đồng cho Bên A vào ngày ký hợp đồng, với số tiền là 
                    <strong th:text="${#numbers.formatDecimal(contract.totalPayment, 0, 'COMMA', 0, 'POINT')}">...</strong> VNĐ.</li>
                <li><strong>Khấu trừ tiền đặt cọc: </strong>Số tiền thanh toán nêu trên đã được khấu trừ tiền đặt cọc từ hợp đồng đặt cọc trước đó (nếu có). 
                    Bên B chỉ cần thanh toán số tiền còn lại sau khi đã trừ đi tiền đặt cọc.</li>
                <li><strong>Phương thức thanh toán: </strong>Bên B thanh toán bằng tiền mặt hoặc chuyển khoản theo thỏa thuận giữa hai bên.</li>
            </ul>
        </div>
    </div>

    <div class="article" th:if="${contract.contractType == 'SALE'}">
        <div class="article-title">ĐIỀU 3. GIAO HÀNG VÀ NHẬN HÀNG</div>
        <div class="article-content">
            <ul>
                <li><strong>Thời hạn giao xe: </strong>Bên A sẽ giao xe cho Bên B trong ngày ký hợp đồng mua bán xe này;</li>
                <li><strong>Địa điểm giao xe: </strong>Tại trụ sở của Bên A;</li>
                <li><strong>Phương thức giao xe: </strong>Bên A sẽ giao xe trực tiếp cho Bên B, Bên B có trách nhiệm kiểm tra tình trạng xe 
                    trước khi nhận;</li>
                <li><strong>Giấy tờ kèm theo: </strong>Bên A sẽ giao kèm theo xe các giấy tờ liên quan theo quy định của pháp luật.</li>
            </ul>
        </div>
    </div>

    <div class="article">
        <div class="article-title">ĐIỀU 4. BẢN ĐIỀU KHOẢN VÀ ĐIỀU KIỆN CHUNG</div>
        <div class="article-content">
            <p>Bản Điều khoản và Điều kiện chung là một phần không thể tách rời của hợp đồng này, có giá trị dẫn chiếu,
                ràng buộc lên toàn bộ nội dung của hợp đồng.</p>
            <p style="font-style: italic; margin-top: 10px;">Hợp đồng này có hiệu lực từ ngày ký, được lập thành 02 (hai) bản,
                có giá trị pháp lý như nhau, mỗi bên giữ 1 (một) bản làm cơ sở thực hiện.</p>
        </div>
    </div>

    <div class="signatures">
        <div class="signature-box">
            <h3>ĐẠI DIỆN BÊN BÁN</h3>
            <p class="subtitle">(Ký, ghi rõ họ tên và đóng dấu)</p>
        </div>
        <div class="signature-box">
            <h3>ĐẠI DIỆN BÊN MUA</h3>
            <p class="subtitle">(Ký và ghi rõ họ tên)</p>
        </div>
    </div>

    <div style="text-align: center; margin-top: -50px; font-size: 11px;">
        <p>1</p>
    </div>
</div>
</body>
</html>